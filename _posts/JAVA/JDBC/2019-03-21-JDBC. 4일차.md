---
title:  "Java - JDBC 4일차!"

read_time: false
share: false
author_profile: false
classes: wide

categories:
  - jdbc

tags:
  - database
  - java

toc: true

---


## MVC (모델-뷰-컨트롤러) 패턴 

**모델-뷰-컨트롤러(Model–View–Controller, MVC)**는 소프트웨어 공학에서 사용되는 소프트웨어 디자인 패턴이다.(위키)

Model이 처리  
View가 출력  
Controller는 총괄적인 역할을 한다.    

MVC 패턴을 사용하면 오히려 개발속도는 더디지만 나중에 유지보수를 생각하면 사용하는게 더 효율적이다.  

예로 게시글을 MVC패턴으로 만든다면 다음과 같다.  

게시글 목록 보겠다고 요청이 들어왔다.
Controller가 요청을 받으면 Model에게 데이터 처리를 맞긴다.   

Controller가 Model로부터 데이터를 받으면 View에게 출력할 화면을 만들라고 일처리를 맞긴다.    

View가 이쁘게 출력할수 있도록 구성이 끝나면 컨트롤러가 마지막으로 이 데이터를 요청자에게 반환한다.  

tbl_board 테이블을 MVC패턴으로 구성해보자.  

tbl_board은 다음처럼 생겼다.  
![image3]({{ "/assets/java/jdbc/days01/image3.png" | absolute_url }}){: .shadow}  
 
 
게시판 기능을 나름 MVC형태로 구현하려면  
총 6개의 클래스가 필요하다.  
```
1. MyBoardDTO
2. IMyBoardDAO
3. MyBoardDAOImpl
4. MyBoardService
5. MyBoardController
6. main함수 클래스
```

`MyBoardDTO`는 tbl_board 테이블에서 데이터를 받아오기 위한 객체.  
 

`IMyBoardDAO`안에는 게시글에서 할수있는 작업을 인터페이스로 선언한다.  
게시글하면 떠오르는 다음 작업들이 기본적으로 정의되어야 한다. 
```
게시글 작성
게시글 목록
게시글 수정
게시글 삭제
게시글 조회수 증가
게시글 보기
총게시글 수 반환
총페이지 수 반환
```
 
 
`MyBoardImpl`은 `IMyBoardDAO` 구현한 DB와 연결 및 각종 작업별로 데이터를 가져오는 클래스이다.    


`MyBoardService` 클래스는 DAO의 보조적인 역할을 하는 클래스이다.   
~~굳이 없어도 되지만 있으면 좋은?~~  
게시글에서 글을 클릭하면 하는 행동은 **게시글 상세출력** 하나로 볼 수 있지만 실제로 DAO안에선 조회수 증가, 실제글 출력 2가지 작업이 수행된다.  

만약  로그를 추가한다던가 다른 특이작업을 한다면 한 행동안에 2개 이상의 작업이 추가될 수 있다.(물론 DAO에 추가 정의해야함)  

이 여러개의 작업이 하나의 행동으로, 하나의 트랜잭션으로 묶어 동작해야 하는데 `MyBoardService`가 이를 도와준다..

`MyBoardController`는 말 그대로 컨트롤러 역할을 하는 클래스
 
 
 
먼저 Interface를 작성해보자

```java
import java.sql.SQLException;
import java.util.ArrayList;

public interface IMyBoard {
//	게시글 작성
	int insert(MyBoardDTO dto) throws SQLException; 
	//1이면 성공, 0이면 실패, 컨트롤러에서 예외를 처리하기 때문에 예외를 던진다.
	
//	게시글 목록
	ArrayList<MyBoardDTO> select(int curPage, int pageSize) throws SQLException;
	//매개변수로 현재 보고싶은 page를 입력
}
```
일단 2개의 작업만 구현하자...  
 

`IMyBoard` 인터페이스를 구현한 `MyBoardDAOImpl` 클래스를 정의  
```java
package MyBoard;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;

public class MyBoardImpl implements IMyBoard{
	private Connection connection = null;
	private Statement stmt = null;
	private PreparedStatement pstmt = null;
	private ResultSet rs = null;
	@Override
	public int insert(MyBoardDTO dto) throws SQLException {
		return 0;
	}

	@Override
	public ArrayList<MyBoardDTO> select(int curPage, int pageSize) throws SQLException {
		return null;
	}

	public Connection getConnection() {
		return connection;
	}

	public void setConnection(Connection connection) {
		this.connection = connection;
	}
}
```

`MyBoardDAOImpl`는 DB연결을 위한 클래스이기 때문에 당연히 `Connection`객체가 필요하다.(경찰에게 권총이 필요하듯이)  

이런 관계를 **DI(has-a)** 라고한다. (의존성관계)
> https://kouzie.github.io/java/java-DI-관계,-interface,-익명클래스,-Downcasting,-instanceof/#
